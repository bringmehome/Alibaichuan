<!doctype html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width,height=device-height,initial-scale=1.0,user-scalable=0">
		<title>APICloud</title>
		<style>
			body {
				background-color: #ffffff;
			}
			.main {
				padding: 20px 0;
				/*border: 1px solid #c3c3c3;*/
				display: flex;
				justify-content: space-between;
			}
			.contain {
				padding: 10px 0;
				display: flex;
				justify-content: space-between;
			}
			.contain div {
				font-size: 12px;
				color: #072101;
				text-align: left;
			}
			.main div {
				width: 28%;
				font-size: 12px;
				color: #072101;
				padding: 10px 0;
				text-align: center;
			}
			.button1 {
				background-color: coral;
			}
			.button2 {
				background-color: lightblue;
			}
			.button3 {
				background-color: khaki;
			}
			.button4 {
				background-color: pink;
			}
			.imgclass {
				width: 50px;
				height: 50px;
			}
			.myinfoclass {
				width: 70%;
			}
			.ctrlclass {
				padding: 30px;
				text-align: center;
				font-size: 30px;
				color: #2DBD00;
				font-weight: bolder;
			}
		</style>
	</head>
	<body>
		<div class="ctrlclass">
			Feeling.Life
		</div>
		<div class="main">
			<div class="button1" onclick="initSDK()">
				初始化
			</div>
			<div class="button1" onclick="getAliOpen()">
				授权登录
			</div>
			<div class="button1" onclick="logout()">
				退出登录
			</div>
		</div>
		<div class="main">
			<div class="button2" onclick="getUserInfo()">
				获取用户信息
			</div>
			<div class="button3" onclick="openMyCart()">
				我的购物车
			</div>
			<div class="button4" onclick="myOrdersPage()">
				我的订单
			</div>
		</div>
		<div class="main">
			<div class="button3" onclick="showTaokeItemById()">
				打开宝贝ItemID
			</div>
			<div class="button4" onclick="showDetailByURL()">
				打开宝贝URL
			</div>
		</div>
		<div class="contain">
			<div><img src="" class="imgclass" id="mayicon" />
			</div>
			<div class="myinfoclass" id="myinfo"></div>
		</div>
	</body>
	<script type="text/javascript" src="../script/api.js"></script>
	<script type="text/javascript">
		var alibaichuan = null;
		apiready = function() {
			requireali();
		};
		function requireali() {
			alibaichuan = api.require('alibaichuan');
		}

		function initSDK() {
			alert(alibaichuan);
			alibaichuan.initTaeSDK(function(ret, err) {
				if (ret) {
					setinnerHTML(JSON.stringify(ret));
				} else {
					setinnerHTML(JSON.stringify(err));
				}
			});
		}

		function getAliOpen() {
			alibaichuan.showLogin(function(ret, err) {
				if (ret) {
					document.getElementById("mayicon").src = ret.avatarUrl;
					var innerText = "昵称：" + ret.userNick + "<br/>授权码：" + ret.authCode + "<br/>时间：" + ret.loginTime + "<br/>用户ID：" + ret.userId;
					setinnerHTML(innerText);
				} else {
					setinnerHTML(JSON.stringify(err));
				}
			});
		}

		function getUserInfo() {
			alibaichuan.getUserInfo(function(ret, err) {
				if (ret) {
					////console.log("用户信息 ret - " + JSON.stringify(ret));
					document.getElementById("mayicon").src = ret.avatarUrl;
					var innerText = "昵称：" + ret.userNick + "<br/>授权码：" + ret.authCode + "<br/>时间：" + ret.loginTime + "<br/>用户ID：" + ret.userId;
					setinnerHTML(innerText);
				} else {
					setinnerHTML(JSON.stringify(err));
				}
			});
		}

		function logout() {
			alibaichuan.logout(function(ret, err) {
				if (ret) {
					setinnerHTML(JSON.stringify(ret));
				} else {
					setinnerHTML(JSON.stringify(err));
				}
			});
		}

		function openMyCart() {
			alibaichuan.openMyCart(function(ret, err) {
				if (ret) {
					setinnerHTML(JSON.stringify(ret));
				} else {
					setinnerHTML(JSON.stringify(err));
				}
			});
		}

		function myOrdersPage() {
			alibaichuan.myOrdersPage(function(ret, err) {
				if (ret) {
					setinnerHTML(JSON.stringify(ret));
				} else {
					setinnerHTML(JSON.stringify(err));
				}
			});
		}

		function showTaokeItemById() {
			var param = {
				itemid : "530187984567",
				mmpid : "mm_14421418_0_0"
			};
			alibaichuan.showTaokeItemById(param, function(ret, err) {
				if (ret) {
					setinnerHTML(JSON.stringify(ret));
				} else {
					setinnerHTML(JSON.stringify(err));
				}
			});
		}

		function showDetailByURL() {
			var param = {
				url : "https://detail.tmall.com/item.htm?spm=a220o.1000855.1998025129.2.0GCnkE&id=528887107325&pvid=e1fafc63-fd89-4d8b-bec1-53dff12ca7e1&abbucket=_AB-M32_B12&acm=03054.1003.1.587829&aldid=dVZ5IOUG&abtest=_AB-LR32-PR32&scm=1007.12559.23637.100200300000000&pos=2&sku_properties=20509:28383",
				mmpid : "mm_114019109_0_0"
			};
			alibaichuan.showDetailByURL(param, function(ret, err) {
				if (ret) {
					setinnerHTML(JSON.stringify(ret));
				} else {
					setinnerHTML(JSON.stringify(err));
				}
			});
		}

		function setinnerHTML(neir) {
			document.getElementById("myinfo").innerHTML = neir;
		}
	</script>
</html>